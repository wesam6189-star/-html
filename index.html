<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>محول HTML إلى Word - النسخة الاحترافية</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/dracula.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/eclipse.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/htmlmixed/htmlmixed.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/css/css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.0/beautify-html.min.js"></script>
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --bg-color: #f5f7fa;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
            --border-color: #e0e0e0;
            --success-color: #27ae60;
            --error-color: #e74c3c;
            --toolbar-bg: #f8f9fa;
        }

        [data-theme="dark"] {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --bg-color: #1a1a2e;
            --card-bg: #16213e;
            --text-color: #e4e4e4;
            --border-color: #2d3748;
            --success-color: #27ae60;
            --error-color: #e74c3c;
            --toolbar-bg: #0f172a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            padding: 20px;
            transition: all 0.3s ease;
            color: var(--text-color);
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header-title {
            flex: 1;
        }

        .header h1 {
            color: var(--primary-color);
            font-size: 2em;
            margin-bottom: 5px;
        }

        .header p {
            color: var(--text-color);
            opacity: 0.7;
            font-size: 0.95em;
        }

        .header-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .theme-toggle {
            background: var(--toolbar-bg);
            border: 2px solid var(--border-color);
            border-radius: 50px;
            padding: 8px 15px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        .stats-badge {
            background: var(--toolbar-bg);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            padding: 8px 15px;
            font-size: 0.9em;
            font-weight: 600;
            color: var(--text-color);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .panel {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        .panel h2 {
            color: var(--primary-color);
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toolbar {
            background: var(--toolbar-bg);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 15px;
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            border: 1px solid var(--border-color);
        }

        .toolbar-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .toolbar-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .toolbar-btn:active {
            transform: translateY(0);
        }

        .toolbar-btn.active {
            background: var(--primary-color);
            color: white;
        }

        .CodeMirror {
            height: 450px !important;
            border-radius: 10px;
            border: 2px solid var(--border-color);
            font-size: 14px;
        }

        .preview-box {
            flex: 1;
            padding: 20px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            background: var(--bg-color);
            overflow: auto;
            min-height: 450px;
        }

        .controls {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            margin-bottom: 8px;
            color: var(--text-color);
            font-weight: 600;
            font-size: 0.9em;
        }

        .input-group input,
        .input-group select {
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
            background: var(--card-bg);
            color: var(--text-color);
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px;
            background: var(--toolbar-bg);
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--text-color);
        }

        .file-input-label:hover {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: white;
        }

        .button-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }

        button {
            padding: 14px 20px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }

        .btn-secondary {
            background: var(--toolbar-bg);
            color: var(--text-color);
            border: 2px solid var(--border-color);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .status {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            display: block;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header {
                text-align: center;
            }

            .header h1 {
                font-size: 1.5em;
            }

            .controls-grid {
                grid-template-columns: 1fr;
            }

            .toolbar {
                justify-content: center;
            }
        }

        .floating-toolbar {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--card-bg);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            display: flex;
            gap: 10px;
            z-index: 1000;
            border: 2px solid var(--border-color);
        }

        .floating-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: var(--primary-color);
            color: white;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .preview-box img {
            max-width: 100%;
            height: auto;
        }

        .preview-box table {
            border-collapse: collapse;
            width: 100%;
            margin: 10px 0;
        }

        .preview-box table td,
        .preview-box table th {
            border: 1px solid #ddd;
            padding: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-title">
                <h1>🔄 محول HTML إلى Word Pro</h1>
                <p>أداة احترافية متقدمة مع محرر أكواد وتنسيق ذكي</p>
            </div>
            <div class="header-controls">
                <div class="stats-badge" id="statsDisplay">
                    📊 0 كلمة | 0 حرف
                </div>
                <button class="theme-toggle" onclick="toggleTheme()" title="تبديل الوضع">
                    🌓
                </button>
            </div>
        </div>

        <div class="main-content">
            <div class="panel">
                <div class="panel-header">
                    <h2>📝 محرر الأكواد</h2>
                </div>
                
                <div class="toolbar">
                    <button class="toolbar-btn" onclick="insertTag('strong')" title="نص غامق">
                        <strong>B</strong>
                    </button>
                    <button class="toolbar-btn" onclick="insertTag('em')" title="نص مائل">
                        <em>I</em>
                    </button>
                    <button class="toolbar-btn" onclick="insertTag('u')" title="تسطير">
                        <u>U</u>
                    </button>
                    <button class="toolbar-btn" onclick="insertHeading('h1')" title="عنوان رئيسي">
                        H1
                    </button>
                    <button class="toolbar-btn" onclick="insertHeading('h2')" title="عنوان فرعي">
                        H2
                    </button>
                    <button class="toolbar-btn" onclick="insertList('ul')" title="قائمة نقطية">
                        • List
                    </button>
                    <button class="toolbar-btn" onclick="insertList('ol')" title="قائمة مرقمة">
                        1. List
                    </button>
                    <button class="toolbar-btn" onclick="insertTable()" title="إدراج جدول">
                        📊 Table
                    </button>
                    <button class="toolbar-btn" onclick="beautifyHTML()" title="تنظيف الكود">
                        ✨ تنظيف
                    </button>
                </div>

                <textarea id="htmlInput" style="display:none;"></textarea>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <h2>👁️ المعاينة المباشرة</h2>
                </div>
                <div id="preview" class="preview-box">
                    <p style="color: #999; text-align: center;">المعاينة ستظهر هنا...</p>
                </div>
            </div>
        </div>

        <div class="controls">
            <div class="controls-grid">
                <div class="input-group">
                    <label for="fileName">📄 اسم الملف:</label>
                    <input type="text" id="fileName" value="document" placeholder="اسم الملف">
                </div>

                <div class="input-group">
                    <label for="fontSize">🔤 حجم الخط:</label>
                    <select id="fontSize">
                        <option value="12">12 pt - صغير</option>
                        <option value="14" selected>14 pt - عادي</option>
                        <option value="16">16 pt - متوسط</option>
                        <option value="18">18 pt - كبير</option>
                        <option value="20">20 pt - كبير جداً</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="pageMargins">📏 الهوامش:</label>
                    <select id="pageMargins">
                        <option value="narrow">ضيقة (1.27 سم)</option>
                        <option value="normal" selected>عادية (2.54 سم)</option>
                        <option value="wide">عريضة (3.81 سم)</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="pageOrientation">📐 اتجاه الصفحة:</label>
                    <select id="pageOrientation">
                        <option value="portrait" selected>عمودي (Portrait)</option>
                        <option value="landscape">أفقي (Landscape)</option>
                    </select>
                </div>

                <div class="input-group">
                    <label>📁 تحميل ملف HTML:</label>
                    <div class="file-input-wrapper">
                        <input type="file" id="fileInput" accept=".html,.htm" onchange="loadHTMLFile(event)">
                        <label for="fileInput" class="file-input-label">
                            📤 اختر ملف HTML
                        </label>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn-primary" onclick="updatePreview()">
                    👁️ معاينة
                </button>
                <button class="btn-success" onclick="downloadWord()">
                    📥 تحميل Word
                </button>
                <button class="btn-info" onclick="loadSample()">
                    📄 مثال
                </button>
                <button class="btn-warning" onclick="validateHTML()">
                    ✓ فحص الكود
                </button>
                <button class="btn-danger" onclick="clearAll()">
                    🗑️ مسح
                </button>
            </div>

            <div id="status" class="status"></div>
        </div>
    </div>

    <div class="floating-toolbar">
        <button class="floating-btn" onclick="updatePreview()" title="تحديث المعاينة">
            🔄
        </button>
        <button class="floating-btn" onclick="downloadWord()" title="تحميل سريع">
            ⬇️
        </button>
    </div>

    <script>
        let editor;
        let currentTheme = 'light';

        // تهيئة محرر الأكواد
        document.addEventListener('DOMContentLoaded', function() {
            editor = CodeMirror.fromTextArea(document.getElementById('htmlInput'), {
                mode: 'htmlmixed',
                theme: 'eclipse',
                lineNumbers: true,
                lineWrapping: true,
                autoCloseTags: true,
                matchBrackets: true,
                indentUnit: 4,
                tabSize: 4,
                direction: 'ltr'
            });

            editor.setSize('100%', '450px');
            
            editor.on('change', function() {
                updateStats();
                autoSave();
            });

            loadAutoSave();
            
            // تحديث تلقائي للمعاينة
            let typingTimer;
            editor.on('change', function() {
                clearTimeout(typingTimer);
                typingTimer = setTimeout(updatePreview, 1500);
            });
        });

        // تبديل الوضع الليلي/النهاري
        function toggleTheme() {
            const body = document.body;
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            if (currentTheme === 'dark') {
                body.setAttribute('data-theme', 'dark');
                editor.setOption('theme', 'dracula');
            } else {
                body.removeAttribute('data-theme');
                editor.setOption('theme', 'eclipse');
            }
            
            localStorage.setItem('theme', currentTheme);
            showStatus('تم تغيير الوضع إلى ' + (currentTheme === 'dark' ? 'الليلي' : 'النهاري'), 'success');
        }

        // تحميل الوضع المحفوظ
        window.addEventListener('load', function() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                toggleTheme();
            }
        });

        // إدراج وسوم HTML
        function insertTag(tag) {
            const cursor = editor.getCursor();
            const selection = editor.getSelection();
            const text = selection || 'النص هنا';
            editor.replaceSelection(`<${tag}>${text}</${tag}>`);
            editor.focus();
        }

        function insertHeading(level) {
            const cursor = editor.getCursor();
            const selection = editor.getSelection();
            const text = selection || 'العنوان هنا';
            editor.replaceSelection(`<${level}>${text}</${level}>\n`);
            editor.focus();
        }

        function insertList(type) {
            const listHTML = type === 'ul' ? 
                `<ul>\n    <li>عنصر 1</li>\n    <li>عنصر 2</li>\n    <li>عنصر 3</li>\n</ul>\n` :
                `<ol>\n    <li>عنصر 1</li>\n    <li>عنصر 2</li>\n    <li>عنصر 3</li>\n</ol>\n`;
            editor.replaceSelection(listHTML);
            editor.focus();
        }

        function insertTable() {
            const tableHTML = `<table border="1" cellpadding="10" cellspacing="0" style="width: 100%; border-collapse: collapse;">
    <tr>
        <th>العمود 1</th>
        <th>العمود 2</th>
        <th>العمود 3</th>
    </tr>
    <tr>
        <td>البيانات 1</td>
        <td>البيانات 2</td>
        <td>البيانات 3</td>
    </tr>
</table>\n`;
            editor.replaceSelection(tableHTML);
            editor.focus();
        }

        // تنظيف وتجميل الكود
        function beautifyHTML() {
            try {
                const code = editor.getValue();
                const beautified = html_beautify(code, {
                    indent_size: 4,
                    wrap_line_length: 80,
                    preserve_newlines: true
                });
                editor.setValue(beautified);
                showStatus('✨ تم تنظيف الكود بنجاح!', 'success');
            } catch (error) {
                showStatus('⚠️ خطأ في تنظيف الكود', 'error');
            }
        }

        // فحص صحة HTML
        function validateHTML() {
            const code = editor.getValue();
            
            if (!code.trim()) {
                showStatus('⚠️ الرجاء إدخال كود HTML أولاً', 'error');
                return;
            }

            const openTags = code.match(/<([a-z]+)(?:\s|>)/gi) || [];
            const closeTags = code.match(/<\/([a-z]+)>/gi) || [];
            
            let issues = [];
            
            if (openTags.length > closeTags.length) {
                issues.push('هناك وسوم مفتوحة غير مغلقة');
            }
            
            if (!code.includes('<') || !code.includes('>')) {
                issues.push('الكود لا يحتوي على وسوم HTML صحيحة');
            }

            if (issues.length === 0) {
                showStatus('✅ الكود صحيح وجاهز للتحويل!', 'success');
            } else {
                showStatus('⚠️ تحذيرات: ' + issues.join(', '), 'info');
            }
        }

        // تحديث الإحصائيات
        function updateStats() {
            const preview = document.getElementById('preview');
            const text = preview.innerText || preview.textContent || '';
            const words = text.trim().split(/\s+/).filter(w => w.length > 0).length;
            const chars = text.length;
            
            document.getElementById('statsDisplay').textContent = 
                `📊 ${words} كلمة | ${chars} حرف`;
        }

        // تحديث المعاينة
        function updatePreview() {
            const htmlInput = editor.getValue();
            const preview = document.getElementById('preview');
            
            if (!htmlInput.trim()) {
                showStatus('⚠️ الرجاء إدخال كود HTML أولاً', 'error');
                return;
            }

            preview.innerHTML = htmlInput;
            updateStats();
            showStatus('✅ تم تحديث المعاينة بنجاح!', 'success');
        }

        // تحميل ملف HTML
        function loadHTMLFile(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                editor.setValue(e.target.result);
                updatePreview();
                showStatus(`✅ تم تحميل الملف: ${file.name}`, 'success');
            };
            reader.readAsText(file);
        }

        // تحميل Word
        function downloadWord() {
            const htmlInput = editor.getValue();
            const fileName = document.getElementById('fileName').value || 'document';
            const fontSize = document.getElementById('fontSize').value;
            const margins = document.getElementById('pageMargins').value;
            const orientation = document.getElementById('pageOrientation').value;
            
            if (!htmlInput.trim()) {
                showStatus('⚠️ الرجاء إدخال كود HTML أولاً', 'error');
                return;
            }

            try {
                const marginValues = {
                    'narrow': '0.5in',
                    'normal': '1in',
                    'wide': '1.5in'
                };

                const fullHtml = `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        @page {
            size: ${orientation === 'landscape' ? 'landscape' : 'portrait'};
            margin: ${marginValues[margins]};
        }
        body { 
            font-family: Arial, sans-serif; 
            line-height: 1.6;
            font-size: ${fontSize}pt;
            direction: rtl;
            text-align: right;
        }
        table { 
            border-collapse: collapse; 
            width: 100%; 
            margin: 15px 0;
        }
        table td, table th { 
            border: 1px solid #000; 
            padding: 8px; 
        }
        img { 
            max-width: 100%; 
            height: auto; 
        }
        h1, h2, h3, h4, h5, h6 {
            color: #2c3e50;
            margin: 15px 0 10px 0;
        }
        p {
            margin: 10px 0;
        }
        ul, ol {
            margin: 10px 0;
            padding-right: 30px;
        }
    </style>
</head>
<body>
    ${htmlInput}
</body>
</html>`;

                const blob = new Blob(['\ufeff', fullHtml], {
                    type: 'application/msword'
                });

                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `${fileName}.doc`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

                showStatus(`✅ تم تحميل الملف "${fileName}.doc" بنجاح!`, 'success');
            } catch (error) {
                showStatus('❌ حدث خطأ أثناء التحويل', 'error');
                console.error(error);
            }
        }

        // تحميل مثال توضيحي
        function loadSample() {
            const sample = `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            direction: rtl;
            text-align: right;
            padding: 20px;
            line-height: 1.8;
        }
        h1 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        h2 { color: #3498db; margin-top: 25px; }
        h3 { color: #27ae60; }
        .highlight {
            background-color: #ffffcc;
            padding: 15px;
            border-right: 4px solid #f39c12;
            margin: 15px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        table th {
            background-color: #3498db;
            color: white;
            padding: 12px;
        }
        table td {
            padding: 10px;
            border: 1px solid #ddd;
        }
        table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .info-box {
            background-color: #e8f4f8;
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <h1>📄 مستند احترافي تجريبي</h1>
    
    <div class="info-box">
        <h2>🎯 مقدمة</h2>
        <p>
            هذا مثال توضيحي شامل يوضح إمكانيات محول HTML إلى Word الاحترافي.
            يمكنك استخدام جميع عناصر HTML مع التنسيقات المتقدمة للحصول على 
            مستندات Word ذات جودة عالية واحترافية.
        </p>
    </div>

    <h2>✨ المميزات الرئيسية</h2>
    <ul>
        <li><strong>محرر أكواد متطور</strong> مع إبراز الأكواد الملون</li>
        <li><strong>معاينة فورية</strong> لرؤية النتيجة مباشرة</li>
        <li><strong>تنسيقات قابلة للتخصيص</strong> (حجم الخط، الهوامش، الاتجاه)</li>
        <li><strong>أدوات تنسيق سريعة</strong> لإضافة العناصر بسهولة</li>
        <li><strong>وضع ليلي/نهاري</strong> لراحة العينين</li>
        <li><strong>إحصائيات مباشرة</strong> لعدد الكلمات والأحرف</li>
    </ul>

    <h2>📊 مثال على جدول احترافي</h2>
    <table>
        <thead>
            <tr>
                <th>الميزة</th>
                <th>الوصف</th>
                <th>التقييم</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>محرر الأكواد</td>
                <td>محرر CodeMirror مع إبراز الأكواد</td>
                <td>⭐⭐⭐⭐⭐</td>
            </tr>
            <tr>
                <td>التنسيقات</td>
                <td>خيارات متعددة للخطوط والهوامش</td>
                <td>⭐⭐⭐⭐⭐</td>
            </tr>
            <tr>
                <td>الأدوات</td>
                <td>شريط أدوات تنسيق سريع</td>
                <td>⭐⭐⭐⭐⭐</td>
            </tr>
            <tr>
                <td>الواجهة</td>
                <td>تصميم عصري مع وضع ليلي</td>
                <td>⭐⭐⭐⭐⭐</td>
            </tr>
        </tbody>
    </table>

    <h2>🎨 أنواع التنسيقات المدعومة</h2>
    
    <h3>النصوص:</h3>
    <p>
        يمكنك استخدام <strong>نص غامق</strong> و <em>نص مائل</em> و 
        <u>نص مسطر</u> و <del>نص محذوف</del> وحتى 
        <mark>نص مميز بخلفية</mark>.
    </p>

    <h3>القوائم المرقمة:</h3>
    <ol>
        <li>افتح الأداة</li>
        <li>اكتب أو الصق كود HTML</li>
        <li>اضبط الإعدادات حسب رغبتك</li>
        <li>اضغط معاينة لرؤية النتيجة</li>
        <li>حمل الملف بصيغة Word</li>
    </ol>

    <div class="highlight">
        <h3>💡 نصيحة مهمة</h3>
        <p>
            <strong>للحصول على أفضل النتائج:</strong>
        </p>
        <ul>
            <li>استخدم التنسيقات المضمنة (inline styles)</li>
            <li>تجنب استخدام JavaScript في المحتوى</li>
            <li>استخدم الجداول البسيطة</li>
            <li>اختبر المعاينة قبل التحميل</li>
        </ul>
    </div>

    <h2>📝 اقتباس نصي</h2>
    <blockquote style="border-right: 4px solid #3498db; padding-right: 15px; margin: 20px 0; font-style: italic; color: #555;">
        "الأدوات الاحترافية تجعل العمل أسهل وأسرع، ومحول HTML إلى Word 
        يوفر لك الوقت والجهد في إنشاء مستندات Word عالية الجودة من أكواد HTML."
    </blockquote>

    <h2>🔗 روابط وعناصر أخرى</h2>
    <p>
        يمكنك إضافة <a href="#" style="color: #3498db;">روابط نصية</a> و
        عناوين بريد إلكتروني وغيرها من العناصر التفاعلية.
    </p>

    <div class="info-box">
        <h3>📌 ملاحظة ختامية</h3>
        <p>
            هذا المثال يعرض معظم الإمكانيات المتاحة. يمكنك تعديله أو إنشاء 
            محتوى خاص بك من الصفر. استمتع بالاستخدام! 🎉
        </p>
    </div>
</body>
</html>`;
            
            editor.setValue(sample);
            updatePreview();
            showStatus('✅ تم تحميل المثال التوضيحي', 'success');
        }

        // مسح الكل
        function clearAll() {
            if (confirm('هل أنت متأكد من مسح جميع البيانات؟')) {
                editor.setValue('');
                document.getElementById('preview').innerHTML = '<p style="color: #999; text-align: center;">المعاينة ستظهر هنا...</p>';
                document.getElementById('fileName').value = 'document';
                document.getElementById('fontSize').value = '14';
                document.getElementById('pageMargins').value = 'normal';
                document.getElementById('pageOrientation').value = 'portrait';
                updateStats();
                localStorage.removeItem('autoSave');
                showStatus('✅ تم مسح جميع البيانات', 'success');
            }
        }

        // رسائل الحالة
        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
            
            setTimeout(() => {
                status.style.display = 'none';
            }, 5000);
        }

        // حفظ تلقائي
        function autoSave() {
            try {
                const data = {
                    html: editor.getValue(),
                    fileName: document.getElementById('fileName').value,
                    fontSize: document.getElementById('fontSize').value,
                    margins: document.getElementById('pageMargins').value,
                    orientation: document.getElementById('pageOrientation').value
                };
                localStorage.setItem('autoSave', JSON.stringify(data));
            } catch (e) {
                console.warn('Auto-save failed:', e);
            }
        }

        // استعادة الحفظ التلقائي
        function loadAutoSave() {
            try {
                const saved = localStorage.getItem('autoSave');
                if (saved) {
                    const data = JSON.parse(saved);
                    editor.setValue(data.html || '');
                    document.getElementById('fileName').value = data.fileName || 'document';
                    document.getElementById('fontSize').value = data.fontSize || '14';
                    document.getElementById('pageMargins').value = data.margins || 'normal';
                    document.getElementById('pageOrientation').value = data.orientation || 'portrait';
                    
                    if (data.html) {
                        showStatus('📂 تم استعادة المسودة المحفوظة', 'info');
                    }
                }
            } catch (e) {
                console.warn('Load auto-save failed:', e);
            }
        }

        // اختصارات لوحة المفاتيح
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + S للحفظ
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                downloadWord();
            }
            
            // Ctrl/Cmd + P للمعاينة
            if ((e.ctrlKey || e.metaKey) && e.key === 'p') {
                e.preventDefault();
                updatePreview();
            }

            // Ctrl/Cmd + B للنص الغامق
            if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
                e.preventDefault();
                insertTag('strong');
            }

            // Ctrl/Cmd + I للنص المائل
            if ((e.ctrlKey || e.metaKey) && e.key === 'i') {
                e.preventDefault();
                insertTag('em');
            }
        });

        // حفظ الإعدادات عند التغيير
        ['fileName', 'fontSize', 'pageMargins', 'pageOrientation'].forEach(id => {
            document.getElementById(id).addEventListener('change', autoSave);
        });
    </script>
</body>
</html>