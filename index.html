<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­ÙˆÙ„ HTML Ø¥Ù„Ù‰ Word - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/dracula.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/eclipse.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/htmlmixed/htmlmixed.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/xml/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/css/css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.0/beautify-html.min.js"></script>
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --bg-color: #f5f7fa;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
            --border-color: #e0e0e0;
            --success-color: #27ae60;
            --error-color: #e74c3c;
            --toolbar-bg: #f8f9fa;
        }

        [data-theme="dark"] {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --bg-color: #1a1a2e;
            --card-bg: #16213e;
            --text-color: #e4e4e4;
            --border-color: #2d3748;
            --success-color: #27ae60;
            --error-color: #e74c3c;
            --toolbar-bg: #0f172a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            padding: 20px;
            transition: all 0.3s ease;
            color: var(--text-color);
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header-title {
            flex: 1;
        }

        .header h1 {
            color: var(--primary-color);
            font-size: 2em;
            margin-bottom: 5px;
        }

        .header p {
            color: var(--text-color);
            opacity: 0.7;
            font-size: 0.95em;
        }

        .header-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .theme-toggle {
            background: var(--toolbar-bg);
            border: 2px solid var(--border-color);
            border-radius: 50px;
            padding: 8px 15px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        .stats-badge {
            background: var(--toolbar-bg);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            padding: 8px 15px;
            font-size: 0.9em;
            font-weight: 600;
            color: var(--text-color);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .panel {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        .panel h2 {
            color: var(--primary-color);
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .toolbar {
            background: var(--toolbar-bg);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 15px;
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
            border: 1px solid var(--border-color);
        }

        .toolbar-btn {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
            color: var(--text-color);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .toolbar-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .toolbar-btn:active {
            transform: translateY(0);
        }

        .toolbar-btn.active {
            background: var(--primary-color);
            color: white;
        }

        .CodeMirror {
            height: 450px !important;
            border-radius: 10px;
            border: 2px solid var(--border-color);
            font-size: 14px;
        }

        .preview-box {
            flex: 1;
            padding: 20px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            background: var(--bg-color);
            overflow: auto;
            min-height: 450px;
        }

        .controls {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            margin-bottom: 8px;
            color: var(--text-color);
            font-weight: 600;
            font-size: 0.9em;
        }

        .input-group input,
        .input-group select {
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
            background: var(--card-bg);
            color: var(--text-color);
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 12px;
            background: var(--toolbar-bg);
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--text-color);
        }

        .file-input-label:hover {
            border-color: var(--primary-color);
            background: var(--primary-color);
            color: white;
        }

        .button-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 12px;
            margin-top: 20px;
        }

        button {
            padding: 14px 20px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
        }

        .btn-secondary {
            background: var(--toolbar-bg);
            color: var(--text-color);
            border: 2px solid var(--border-color);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .status {
            margin-top: 15px;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            display: none;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            display: block;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            display: block;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            display: block;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header {
                text-align: center;
            }

            .header h1 {
                font-size: 1.5em;
            }

            .controls-grid {
                grid-template-columns: 1fr;
            }

            .toolbar {
                justify-content: center;
            }
        }

        .floating-toolbar {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--card-bg);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            display: flex;
            gap: 10px;
            z-index: 1000;
            border: 2px solid var(--border-color);
        }

        .floating-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: var(--primary-color);
            color: white;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .preview-box img {
            max-width: 100%;
            height: auto;
        }

        .preview-box table {
            border-collapse: collapse;
            width: 100%;
            margin: 10px 0;
        }

        .preview-box table td,
        .preview-box table th {
            border: 1px solid #ddd;
            padding: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-title">
                <h1>ğŸ”„ Ù…Ø­ÙˆÙ„ HTML Ø¥Ù„Ù‰ Word Pro</h1>
                <p>Ø£Ø¯Ø§Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù…ØªÙ‚Ø¯Ù…Ø© Ù…Ø¹ Ù…Ø­Ø±Ø± Ø£ÙƒÙˆØ§Ø¯ ÙˆØªÙ†Ø³ÙŠÙ‚ Ø°ÙƒÙŠ</p>
            </div>
            <div class="header-controls">
                <div class="stats-badge" id="statsDisplay">
                    ğŸ“Š 0 ÙƒÙ„Ù…Ø© | 0 Ø­Ø±Ù
                </div>
                <button class="theme-toggle" onclick="toggleTheme()" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹">
                    ğŸŒ“
                </button>
            </div>
        </div>

        <div class="main-content">
            <div class="panel">
                <div class="panel-header">
                    <h2>ğŸ“ Ù…Ø­Ø±Ø± Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</h2>
                </div>
                
                <div class="toolbar">
                    <button class="toolbar-btn" onclick="insertTag('strong')" title="Ù†Øµ ØºØ§Ù…Ù‚">
                        <strong>B</strong>
                    </button>
                    <button class="toolbar-btn" onclick="insertTag('em')" title="Ù†Øµ Ù…Ø§Ø¦Ù„">
                        <em>I</em>
                    </button>
                    <button class="toolbar-btn" onclick="insertTag('u')" title="ØªØ³Ø·ÙŠØ±">
                        <u>U</u>
                    </button>
                    <button class="toolbar-btn" onclick="insertHeading('h1')" title="Ø¹Ù†ÙˆØ§Ù† Ø±Ø¦ÙŠØ³ÙŠ">
                        H1
                    </button>
                    <button class="toolbar-btn" onclick="insertHeading('h2')" title="Ø¹Ù†ÙˆØ§Ù† ÙØ±Ø¹ÙŠ">
                        H2
                    </button>
                    <button class="toolbar-btn" onclick="insertList('ul')" title="Ù‚Ø§Ø¦Ù…Ø© Ù†Ù‚Ø·ÙŠØ©">
                        â€¢ List
                    </button>
                    <button class="toolbar-btn" onclick="insertList('ol')" title="Ù‚Ø§Ø¦Ù…Ø© Ù…Ø±Ù‚Ù…Ø©">
                        1. List
                    </button>
                    <button class="toolbar-btn" onclick="insertTable()" title="Ø¥Ø¯Ø±Ø§Ø¬ Ø¬Ø¯ÙˆÙ„">
                        ğŸ“Š Table
                    </button>
                    <button class="toolbar-btn" onclick="beautifyHTML()" title="ØªÙ†Ø¸ÙŠÙ Ø§Ù„ÙƒÙˆØ¯">
                        âœ¨ ØªÙ†Ø¸ÙŠÙ
                    </button>
                </div>

                <textarea id="htmlInput" style="display:none;"></textarea>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <h2>ğŸ‘ï¸ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©</h2>
                </div>
                <div id="preview" class="preview-box">
                    <p style="color: #999; text-align: center;">Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§...</p>
                </div>
            </div>
        </div>

        <div class="controls">
            <div class="controls-grid">
                <div class="input-group">
                    <label for="fileName">ğŸ“„ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù:</label>
                    <input type="text" id="fileName" value="document" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù">
                </div>

                <div class="input-group">
                    <label for="fontSize">ğŸ”¤ Ø­Ø¬Ù… Ø§Ù„Ø®Ø·:</label>
                    <select id="fontSize">
                        <option value="12">12 pt - ØµØºÙŠØ±</option>
                        <option value="14" selected>14 pt - Ø¹Ø§Ø¯ÙŠ</option>
                        <option value="16">16 pt - Ù…ØªÙˆØ³Ø·</option>
                        <option value="18">18 pt - ÙƒØ¨ÙŠØ±</option>
                        <option value="20">20 pt - ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="pageMargins">ğŸ“ Ø§Ù„Ù‡ÙˆØ§Ù…Ø´:</label>
                    <select id="pageMargins">
                        <option value="narrow">Ø¶ÙŠÙ‚Ø© (1.27 Ø³Ù…)</option>
                        <option value="normal" selected>Ø¹Ø§Ø¯ÙŠØ© (2.54 Ø³Ù…)</option>
                        <option value="wide">Ø¹Ø±ÙŠØ¶Ø© (3.81 Ø³Ù…)</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="pageOrientation">ğŸ“ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØµÙØ­Ø©:</label>
                    <select id="pageOrientation">
                        <option value="portrait" selected>Ø¹Ù…ÙˆØ¯ÙŠ (Portrait)</option>
                        <option value="landscape">Ø£ÙÙ‚ÙŠ (Landscape)</option>
                    </select>
                </div>

                <div class="input-group">
                    <label>ğŸ“ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù HTML:</label>
                    <div class="file-input-wrapper">
                        <input type="file" id="fileInput" accept=".html,.htm" onchange="loadHTMLFile(event)">
                        <label for="fileInput" class="file-input-label">
                            ğŸ“¤ Ø§Ø®ØªØ± Ù…Ù„Ù HTML
                        </label>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button class="btn-primary" onclick="updatePreview()">
                    ğŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø©
                </button>
                <button class="btn-success" onclick="downloadWord()">
                    ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Word
                </button>
                <button class="btn-info" onclick="loadSample()">
                    ğŸ“„ Ù…Ø«Ø§Ù„
                </button>
                <button class="btn-warning" onclick="validateHTML()">
                    âœ“ ÙØ­Øµ Ø§Ù„ÙƒÙˆØ¯
                </button>
                <button class="btn-danger" onclick="clearAll()">
                    ğŸ—‘ï¸ Ù…Ø³Ø­
                </button>
            </div>

            <div id="status" class="status"></div>
        </div>
    </div>

    <div class="floating-toolbar">
        <button class="floating-btn" onclick="updatePreview()" title="ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©">
            ğŸ”„
        </button>
        <button class="floating-btn" onclick="downloadWord()" title="ØªØ­Ù…ÙŠÙ„ Ø³Ø±ÙŠØ¹">
            â¬‡ï¸
        </button>
    </div>

    <script>
        let editor;
        let currentTheme = 'light';

        // ØªÙ‡ÙŠØ¦Ø© Ù…Ø­Ø±Ø± Ø§Ù„Ø£ÙƒÙˆØ§Ø¯
        document.addEventListener('DOMContentLoaded', function() {
            editor = CodeMirror.fromTextArea(document.getElementById('htmlInput'), {
                mode: 'htmlmixed',
                theme: 'eclipse',
                lineNumbers: true,
                lineWrapping: true,
                autoCloseTags: true,
                matchBrackets: true,
                indentUnit: 4,
                tabSize: 4,
                direction: 'ltr'
            });

            editor.setSize('100%', '450px');
            
            editor.on('change', function() {
                updateStats();
                autoSave();
            });

            loadAutoSave();
            
            // ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
            let typingTimer;
            editor.on('change', function() {
                clearTimeout(typingTimer);
                typingTimer = setTimeout(updatePreview, 1500);
            });
        });

        // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ/Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ
        function toggleTheme() {
            const body = document.body;
            currentTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            if (currentTheme === 'dark') {
                body.setAttribute('data-theme', 'dark');
                editor.setOption('theme', 'dracula');
            } else {
                body.removeAttribute('data-theme');
                editor.setOption('theme', 'eclipse');
            }
            
            localStorage.setItem('theme', currentTheme);
            showStatus('ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„ÙˆØ¶Ø¹ Ø¥Ù„Ù‰ ' + (currentTheme === 'dark' ? 'Ø§Ù„Ù„ÙŠÙ„ÙŠ' : 'Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ'), 'success');
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸
        window.addEventListener('load', function() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                toggleTheme();
            }
        });

        // Ø¥Ø¯Ø±Ø§Ø¬ ÙˆØ³ÙˆÙ… HTML
        function insertTag(tag) {
            const cursor = editor.getCursor();
            const selection = editor.getSelection();
            const text = selection || 'Ø§Ù„Ù†Øµ Ù‡Ù†Ø§';
            editor.replaceSelection(`<${tag}>${text}</${tag}>`);
            editor.focus();
        }

        function insertHeading(level) {
            const cursor = editor.getCursor();
            const selection = editor.getSelection();
            const text = selection || 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ù‡Ù†Ø§';
            editor.replaceSelection(`<${level}>${text}</${level}>\n`);
            editor.focus();
        }

        function insertList(type) {
            const listHTML = type === 'ul' ? 
                `<ul>\n    <li>Ø¹Ù†ØµØ± 1</li>\n    <li>Ø¹Ù†ØµØ± 2</li>\n    <li>Ø¹Ù†ØµØ± 3</li>\n</ul>\n` :
                `<ol>\n    <li>Ø¹Ù†ØµØ± 1</li>\n    <li>Ø¹Ù†ØµØ± 2</li>\n    <li>Ø¹Ù†ØµØ± 3</li>\n</ol>\n`;
            editor.replaceSelection(listHTML);
            editor.focus();
        }

        function insertTable() {
            const tableHTML = `<table border="1" cellpadding="10" cellspacing="0" style="width: 100%; border-collapse: collapse;">
    <tr>
        <th>Ø§Ù„Ø¹Ù…ÙˆØ¯ 1</th>
        <th>Ø§Ù„Ø¹Ù…ÙˆØ¯ 2</th>
        <th>Ø§Ù„Ø¹Ù…ÙˆØ¯ 3</th>
    </tr>
    <tr>
        <td>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª 1</td>
        <td>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª 2</td>
        <td>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª 3</td>
    </tr>
</table>\n`;
            editor.replaceSelection(tableHTML);
            editor.focus();
        }

        // ØªÙ†Ø¸ÙŠÙ ÙˆØªØ¬Ù…ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯
        function beautifyHTML() {
            try {
                const code = editor.getValue();
                const beautified = html_beautify(code, {
                    indent_size: 4,
                    wrap_line_length: 80,
                    preserve_newlines: true
                });
                editor.setValue(beautified);
                showStatus('âœ¨ ØªÙ… ØªÙ†Ø¸ÙŠÙ Ø§Ù„ÙƒÙˆØ¯ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            } catch (error) {
                showStatus('âš ï¸ Ø®Ø·Ø£ ÙÙŠ ØªÙ†Ø¸ÙŠÙ Ø§Ù„ÙƒÙˆØ¯', 'error');
            }
        }

        // ÙØ­Øµ ØµØ­Ø© HTML
        function validateHTML() {
            const code = editor.getValue();
            
            if (!code.trim()) {
                showStatus('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ HTML Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }

            const openTags = code.match(/<([a-z]+)(?:\s|>)/gi) || [];
            const closeTags = code.match(/<\/([a-z]+)>/gi) || [];
            
            let issues = [];
            
            if (openTags.length > closeTags.length) {
                issues.push('Ù‡Ù†Ø§Ùƒ ÙˆØ³ÙˆÙ… Ù…ÙØªÙˆØ­Ø© ØºÙŠØ± Ù…ØºÙ„Ù‚Ø©');
            }
            
            if (!code.includes('<') || !code.includes('>')) {
                issues.push('Ø§Ù„ÙƒÙˆØ¯ Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙˆØ³ÙˆÙ… HTML ØµØ­ÙŠØ­Ø©');
            }

            if (issues.length === 0) {
                showStatus('âœ… Ø§Ù„ÙƒÙˆØ¯ ØµØ­ÙŠØ­ ÙˆØ¬Ø§Ù‡Ø² Ù„Ù„ØªØ­ÙˆÙŠÙ„!', 'success');
            } else {
                showStatus('âš ï¸ ØªØ­Ø°ÙŠØ±Ø§Øª: ' + issues.join(', '), 'info');
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function updateStats() {
            const preview = document.getElementById('preview');
            const text = preview.innerText || preview.textContent || '';
            const words = text.trim().split(/\s+/).filter(w => w.length > 0).length;
            const chars = text.length;
            
            document.getElementById('statsDisplay').textContent = 
                `ğŸ“Š ${words} ÙƒÙ„Ù…Ø© | ${chars} Ø­Ø±Ù`;
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
        function updatePreview() {
            const htmlInput = editor.getValue();
            const preview = document.getElementById('preview');
            
            if (!htmlInput.trim()) {
                showStatus('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ HTML Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }

            preview.innerHTML = htmlInput;
            updateStats();
            showStatus('âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        }

        // ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù HTML
        function loadHTMLFile(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                editor.setValue(e.target.result);
                updatePreview();
                showStatus(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù: ${file.name}`, 'success');
            };
            reader.readAsText(file);
        }

        // ØªØ­Ù…ÙŠÙ„ Word
        function downloadWord() {
            const htmlInput = editor.getValue();
            const fileName = document.getElementById('fileName').value || 'document';
            const fontSize = document.getElementById('fontSize').value;
            const margins = document.getElementById('pageMargins').value;
            const orientation = document.getElementById('pageOrientation').value;
            
            if (!htmlInput.trim()) {
                showStatus('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ HTML Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }

            try {
                const marginValues = {
                    'narrow': '0.5in',
                    'normal': '1in',
                    'wide': '1.5in'
                };

                const fullHtml = `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        @page {
            size: ${orientation === 'landscape' ? 'landscape' : 'portrait'};
            margin: ${marginValues[margins]};
        }
        body { 
            font-family: Arial, sans-serif; 
            line-height: 1.6;
            font-size: ${fontSize}pt;
            direction: rtl;
            text-align: right;
        }
        table { 
            border-collapse: collapse; 
            width: 100%; 
            margin: 15px 0;
        }
        table td, table th { 
            border: 1px solid #000; 
            padding: 8px; 
        }
        img { 
            max-width: 100%; 
            height: auto; 
        }
        h1, h2, h3, h4, h5, h6 {
            color: #2c3e50;
            margin: 15px 0 10px 0;
        }
        p {
            margin: 10px 0;
        }
        ul, ol {
            margin: 10px 0;
            padding-right: 30px;
        }
    </style>
</head>
<body>
    ${htmlInput}
</body>
</html>`;

                const blob = new Blob(['\ufeff', fullHtml], {
                    type: 'application/msword'
                });

                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `${fileName}.doc`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

                showStatus(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù "${fileName}.doc" Ø¨Ù†Ø¬Ø§Ø­!`, 'success');
            } catch (error) {
                showStatus('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­ÙˆÙŠÙ„', 'error');
                console.error(error);
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ù…Ø«Ø§Ù„ ØªÙˆØ¶ÙŠØ­ÙŠ
        function loadSample() {
            const sample = `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: Arial, sans-serif;
            direction: rtl;
            text-align: right;
            padding: 20px;
            line-height: 1.8;
        }
        h1 { color: #2c3e50; border-bottom: 3px solid #3498db; padding-bottom: 10px; }
        h2 { color: #3498db; margin-top: 25px; }
        h3 { color: #27ae60; }
        .highlight {
            background-color: #ffffcc;
            padding: 15px;
            border-right: 4px solid #f39c12;
            margin: 15px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        table th {
            background-color: #3498db;
            color: white;
            padding: 12px;
        }
        table td {
            padding: 10px;
            border: 1px solid #ddd;
        }
        table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .info-box {
            background-color: #e8f4f8;
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ“„ Ù…Ø³ØªÙ†Ø¯ Ø§Ø­ØªØ±Ø§ÙÙŠ ØªØ¬Ø±ÙŠØ¨ÙŠ</h1>
    
    <div class="info-box">
        <h2>ğŸ¯ Ù…Ù‚Ø¯Ù…Ø©</h2>
        <p>
            Ù‡Ø°Ø§ Ù…Ø«Ø§Ù„ ØªÙˆØ¶ÙŠØ­ÙŠ Ø´Ø§Ù…Ù„ ÙŠÙˆØ¶Ø­ Ø¥Ù…ÙƒØ§Ù†ÙŠØ§Øª Ù…Ø­ÙˆÙ„ HTML Ø¥Ù„Ù‰ Word Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ.
            ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¬Ù…ÙŠØ¹ Ø¹Ù†Ø§ØµØ± HTML Ù…Ø¹ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ 
            Ù…Ø³ØªÙ†Ø¯Ø§Øª Word Ø°Ø§Øª Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ© ÙˆØ§Ø­ØªØ±Ø§ÙÙŠØ©.
        </p>
    </div>

    <h2>âœ¨ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h2>
    <ul>
        <li><strong>Ù…Ø­Ø±Ø± Ø£ÙƒÙˆØ§Ø¯ Ù…ØªØ·ÙˆØ±</strong> Ù…Ø¹ Ø¥Ø¨Ø±Ø§Ø² Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ù„ÙˆÙ†</li>
        <li><strong>Ù…Ø¹Ø§ÙŠÙ†Ø© ÙÙˆØ±ÙŠØ©</strong> Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù†ØªÙŠØ¬Ø© Ù…Ø¨Ø§Ø´Ø±Ø©</li>
        <li><strong>ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ®ØµÙŠØµ</strong> (Ø­Ø¬Ù… Ø§Ù„Ø®Ø·ØŒ Ø§Ù„Ù‡ÙˆØ§Ù…Ø´ØŒ Ø§Ù„Ø§ØªØ¬Ø§Ù‡)</li>
        <li><strong>Ø£Ø¯ÙˆØ§Øª ØªÙ†Ø³ÙŠÙ‚ Ø³Ø±ÙŠØ¹Ø©</strong> Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¨Ø³Ù‡ÙˆÙ„Ø©</li>
        <li><strong>ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ/Ù†Ù‡Ø§Ø±ÙŠ</strong> Ù„Ø±Ø§Ø­Ø© Ø§Ù„Ø¹ÙŠÙ†ÙŠÙ†</li>
        <li><strong>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…Ø¨Ø§Ø´Ø±Ø©</strong> Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„Ù…Ø§Øª ÙˆØ§Ù„Ø£Ø­Ø±Ù</li>
    </ul>

    <h2>ğŸ“Š Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø¬Ø¯ÙˆÙ„ Ø§Ø­ØªØ±Ø§ÙÙŠ</h2>
    <table>
        <thead>
            <tr>
                <th>Ø§Ù„Ù…ÙŠØ²Ø©</th>
                <th>Ø§Ù„ÙˆØµÙ</th>
                <th>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Ù…Ø­Ø±Ø± Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</td>
                <td>Ù…Ø­Ø±Ø± CodeMirror Ù…Ø¹ Ø¥Ø¨Ø±Ø§Ø² Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</td>
                <td>â­â­â­â­â­</td>
            </tr>
            <tr>
                <td>Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª</td>
                <td>Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø© Ù„Ù„Ø®Ø·ÙˆØ· ÙˆØ§Ù„Ù‡ÙˆØ§Ù…Ø´</td>
                <td>â­â­â­â­â­</td>
            </tr>
            <tr>
                <td>Ø§Ù„Ø£Ø¯ÙˆØ§Øª</td>
                <td>Ø´Ø±ÙŠØ· Ø£Ø¯ÙˆØ§Øª ØªÙ†Ø³ÙŠÙ‚ Ø³Ø±ÙŠØ¹</td>
                <td>â­â­â­â­â­</td>
            </tr>
            <tr>
                <td>Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©</td>
                <td>ØªØµÙ…ÙŠÙ… Ø¹ØµØ±ÙŠ Ù…Ø¹ ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ</td>
                <td>â­â­â­â­â­</td>
            </tr>
        </tbody>
    </table>

    <h2>ğŸ¨ Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©</h2>
    
    <h3>Ø§Ù„Ù†ØµÙˆØµ:</h3>
    <p>
        ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… <strong>Ù†Øµ ØºØ§Ù…Ù‚</strong> Ùˆ <em>Ù†Øµ Ù…Ø§Ø¦Ù„</em> Ùˆ 
        <u>Ù†Øµ Ù…Ø³Ø·Ø±</u> Ùˆ <del>Ù†Øµ Ù…Ø­Ø°ÙˆÙ</del> ÙˆØ­ØªÙ‰ 
        <mark>Ù†Øµ Ù…Ù…ÙŠØ² Ø¨Ø®Ù„ÙÙŠØ©</mark>.
    </p>

    <h3>Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø±Ù‚Ù…Ø©:</h3>
    <ol>
        <li>Ø§ÙØªØ­ Ø§Ù„Ø£Ø¯Ø§Ø©</li>
        <li>Ø§ÙƒØªØ¨ Ø£Ùˆ Ø§Ù„ØµÙ‚ ÙƒÙˆØ¯ HTML</li>
        <li>Ø§Ø¶Ø¨Ø· Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø­Ø³Ø¨ Ø±ØºØ¨ØªÙƒ</li>
        <li>Ø§Ø¶ØºØ· Ù…Ø¹Ø§ÙŠÙ†Ø© Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù†ØªÙŠØ¬Ø©</li>
        <li>Ø­Ù…Ù„ Ø§Ù„Ù…Ù„Ù Ø¨ØµÙŠØºØ© Word</li>
    </ol>

    <div class="highlight">
        <h3>ğŸ’¡ Ù†ØµÙŠØ­Ø© Ù…Ù‡Ù…Ø©</h3>
        <p>
            <strong>Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£ÙØ¶Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬:</strong>
        </p>
        <ul>
            <li>Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù…Ø¶Ù…Ù†Ø© (inline styles)</li>
            <li>ØªØ¬Ù†Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù… JavaScript ÙÙŠ Ø§Ù„Ù…Ø­ØªÙˆÙ‰</li>
            <li>Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø¨Ø³ÙŠØ·Ø©</li>
            <li>Ø§Ø®ØªØ¨Ø± Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ù‚Ø¨Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„</li>
        </ul>
    </div>

    <h2>ğŸ“ Ø§Ù‚ØªØ¨Ø§Ø³ Ù†ØµÙŠ</h2>
    <blockquote style="border-right: 4px solid #3498db; padding-right: 15px; margin: 20px 0; font-style: italic; color: #555;">
        "Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© ØªØ¬Ø¹Ù„ Ø§Ù„Ø¹Ù…Ù„ Ø£Ø³Ù‡Ù„ ÙˆØ£Ø³Ø±Ø¹ØŒ ÙˆÙ…Ø­ÙˆÙ„ HTML Ø¥Ù„Ù‰ Word 
        ÙŠÙˆÙØ± Ù„Ùƒ Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„Ø¬Ù‡Ø¯ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªÙ†Ø¯Ø§Øª Word Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø© Ù…Ù† Ø£ÙƒÙˆØ§Ø¯ HTML."
    </blockquote>

    <h2>ğŸ”— Ø±ÙˆØ§Ø¨Ø· ÙˆØ¹Ù†Ø§ØµØ± Ø£Ø®Ø±Ù‰</h2>
    <p>
        ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© <a href="#" style="color: #3498db;">Ø±ÙˆØ§Ø¨Ø· Ù†ØµÙŠØ©</a> Ùˆ
        Ø¹Ù†Ø§ÙˆÙŠÙ† Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆØºÙŠØ±Ù‡Ø§ Ù…Ù† Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©.
    </p>

    <div class="info-box">
        <h3>ğŸ“Œ Ù…Ù„Ø§Ø­Ø¸Ø© Ø®ØªØ§Ù…ÙŠØ©</h3>
        <p>
            Ù‡Ø°Ø§ Ø§Ù„Ù…Ø«Ø§Ù„ ÙŠØ¹Ø±Ø¶ Ù…Ø¹Ø¸Ù… Ø§Ù„Ø¥Ù…ÙƒØ§Ù†ÙŠØ§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©. ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„Ù‡ Ø£Ùˆ Ø¥Ù†Ø´Ø§Ø¡ 
            Ù…Ø­ØªÙˆÙ‰ Ø®Ø§Øµ Ø¨Ùƒ Ù…Ù† Ø§Ù„ØµÙØ±. Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…! ğŸ‰
        </p>
    </div>
</body>
</html>`;
            
            editor.setValue(sample);
            updatePreview();
            showStatus('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠ', 'success');
        }

        // Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
        function clearAll() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
                editor.setValue('');
                document.getElementById('preview').innerHTML = '<p style="color: #999; text-align: center;">Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§...</p>';
                document.getElementById('fileName').value = 'document';
                document.getElementById('fontSize').value = '14';
                document.getElementById('pageMargins').value = 'normal';
                document.getElementById('pageOrientation').value = 'portrait';
                updateStats();
                localStorage.removeItem('autoSave');
                showStatus('âœ… ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'success');
            }
        }

        // Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø­Ø§Ù„Ø©
        function showStatus(message, type) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
            
            setTimeout(() => {
                status.style.display = 'none';
            }, 5000);
        }

        // Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠ
        function autoSave() {
            try {
                const data = {
                    html: editor.getValue(),
                    fileName: document.getElementById('fileName').value,
                    fontSize: document.getElementById('fontSize').value,
                    margins: document.getElementById('pageMargins').value,
                    orientation: document.getElementById('pageOrientation').value
                };
                localStorage.setItem('autoSave', JSON.stringify(data));
            } catch (e) {
                console.warn('Auto-save failed:', e);
            }
        }

        // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø­ÙØ¸ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        function loadAutoSave() {
            try {
                const saved = localStorage.getItem('autoSave');
                if (saved) {
                    const data = JSON.parse(saved);
                    editor.setValue(data.html || '');
                    document.getElementById('fileName').value = data.fileName || 'document';
                    document.getElementById('fontSize').value = data.fontSize || '14';
                    document.getElementById('pageMargins').value = data.margins || 'normal';
                    document.getElementById('pageOrientation').value = data.orientation || 'portrait';
                    
                    if (data.html) {
                        showStatus('ğŸ“‚ ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø³ÙˆØ¯Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©', 'info');
                    }
                }
            } catch (e) {
                console.warn('Load auto-save failed:', e);
            }
        }

        // Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + S Ù„Ù„Ø­ÙØ¸
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                downloadWord();
            }
            
            // Ctrl/Cmd + P Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
            if ((e.ctrlKey || e.metaKey) && e.key === 'p') {
                e.preventDefault();
                updatePreview();
            }

            // Ctrl/Cmd + B Ù„Ù„Ù†Øµ Ø§Ù„ØºØ§Ù…Ù‚
            if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
                e.preventDefault();
                insertTag('strong');
            }

            // Ctrl/Cmd + I Ù„Ù„Ù†Øµ Ø§Ù„Ù…Ø§Ø¦Ù„
            if ((e.ctrlKey || e.metaKey) && e.key === 'i') {
                e.preventDefault();
                insertTag('em');
            }
        });

        // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„ØªØºÙŠÙŠØ±
        ['fileName', 'fontSize', 'pageMargins', 'pageOrientation'].forEach(id => {
            document.getElementById(id).addEventListener('change', autoSave);
        });
    </script>
</body>
</html>